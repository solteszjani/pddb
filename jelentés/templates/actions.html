{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center">
  <h3>Intézkedések</h3>
  <a class="btn btn-success" href="{{ url_for('new_action') }}">Új intézkedés</a>
</div>

<form class="row g-2 my-2">
  <div class="col-md-4"><input name="q" value="{{ q }}" class="form-control" placeholder="Keresés helyszín/személy/jármű"></div>
  <div class="col-md-2"><input type="date" name="date_from" value="{{ date_from }}" class="form-control"></div>
  <div class="col-md-2"><input type="date" name="date_to" value="{{ date_to }}" class="form-control"></div>
  <div class="col-md-2"><button class="btn btn-outline-primary">Szűr</button></div>
</form>

<div class="card-list">
  {% for a in actions %}
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">{{ a.location }}</h5>
        <h6 class="card-subtitle mb-2 text-muted">{{ a.action_date }} {% if a.action_time %}{{ a.action_time.strftime('%H:%M') }}{% endif %}</h6>
        <p class="card-text"><strong>Személy:</strong> {{ a.person_name or '-' }} | <strong>Jármű:</strong> {{ a.vehicle_info or '-' }}</p>
        <a class="btn btn-sm btn-primary" href="{{ url_for('view_action', action_id=a.id) }}">Megtekint</a>
        {% if current_user==a.created_by or current_user.is_supervisor() or current_user.is_admin() or (current_user.position and current_user.position.name in ['Alosztályvezető','Osztályvezető']) %}
          <a class="btn btn-sm btn-secondary" href="{{ url_for('edit_action', action_id=a.id) }}">Szerkeszt</a>
          <a class="btn btn-sm btn-danger" href="{{ url_for('delete_action', action_id=a.id) }}" onclick="return confirm('Törlöd?')">Töröl</a>
        {% endif %}
      </div>
    </div>
  {% else %}
    <p>Nincsenek intézkedések.</p>
  {% endfor %}
</div>
{% endblock %}
